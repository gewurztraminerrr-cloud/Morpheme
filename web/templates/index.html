<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morpheme - Word Puzzle Generator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <header>
            <h1>Morpheme</h1>
            <nav>
                <button class="nav-btn active" data-tab="login">Login</button>
                <button class="nav-btn" data-tab="lobby">Lobby</button>
                <button class="nav-btn" data-tab="play">Play</button>
                <button class="nav-btn" data-tab="sandbox">Sandbox</button>
                <button class="nav-btn" data-tab="playmode">Play Mode</button>
            </nav>
        </header>

        <main>
            <!-- LOGIN TAB -->
            <section id="login" class="tab-content active">
                <div class="login-container">
                    <h2>Welcome to Morpheme</h2>
                    <div class="login-form">
                        <input type="text" id="username-input" placeholder="Username" autocomplete="username">
                        <input type="password" id="password-input" placeholder="Password"
                            autocomplete="current-password">
                        <button id="login-btn" class="primary-btn">Login</button>
                        <button id="register-btn" class="secondary-btn">Register</button>
                    </div>
                </div>
            </section>



            <!-- LOBBY TAB -->
            <section id="lobby" class="tab-content">
                <div class="lobby-layout-2col">
                    <!-- CENTER: Game Matrices -->
                    <div class="lobby-game-panel">
                        <!-- Audio for Lobby -->
                        <audio id="lobby-music" loop>
                            <source src="{{ url_for('static', filename='audio/lobby-music.mp3') }}" type="audio/mpeg">
                        </audio>

                        <!-- Accumulative -->
                        <div class="game-type-section">
                            <h3>Accumulative</h3>
                            <div class="game-matrix">
                                <!-- Header Row -->
                                <div class="matrix-cell empty"></div>
                                <div class="matrix-cell header">4x4</div>
                                <div class="matrix-cell header">4x6</div>
                                <div class="matrix-cell header">5x7</div>
                                <div class="matrix-cell header">6x8</div>

                                <!-- 45 seconds -->
                                <div class="matrix-cell header">45s</div>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="4" data-h="4"
                                    data-t="45">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="4" data-h="6"
                                    data-t="45">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="5" data-h="7"
                                    data-t="45">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="6" data-h="8"
                                    data-t="45">Start [0]</button>

                                <!-- 3 minutes -->
                                <div class="matrix-cell header">3m</div>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="4" data-h="4"
                                    data-t="180">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="4" data-h="6"
                                    data-t="180">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="5" data-h="7"
                                    data-t="180">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="6" data-h="8"
                                    data-t="180">Start [0]</button>

                                <!-- 10 minutes -->
                                <div class="matrix-cell header">10m</div>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="4" data-h="4"
                                    data-t="600">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="4" data-h="6"
                                    data-t="600">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="5" data-h="7"
                                    data-t="600">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="6" data-h="8"
                                    data-t="600">Start [0]</button>

                                <!-- 24 hours -->
                                <div class="matrix-cell header">24h</div>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="4" data-h="4"
                                    data-t="86400">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="4" data-h="6"
                                    data-t="86400">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="5" data-h="7"
                                    data-t="86400">Start [0]</button>
                                <button class="matrix-btn start-btn" data-type="accumulative" data-w="6" data-h="8"
                                    data-t="86400">Start [0]</button>
                            </div>
                        </div>

                        <!-- First Come First Serve -->
                        <div class="game-type-section">
                            <h3>First Come First Serve</h3>
                            <div class="game-matrix">
                                <!-- Header Row -->
                                <div class="matrix-cell empty"></div>
                                <div class="matrix-cell header">4x4</div>
                                <div class="matrix-cell header">4x6</div>
                                <div class="matrix-cell header">5x7</div>
                                <div class="matrix-cell header">6x8</div>

                                <!-- 45 seconds -->
                                <div class="matrix-cell header">45s</div>
                                <button class="matrix-btn browse-btn" data-type="fcfs" data-w="4" data-h="4"
                                    data-t="45">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="fcfs" data-w="4" data-h="6"
                                    data-t="45">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="fcfs" data-w="5" data-h="7"
                                    data-t="45">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="fcfs" data-w="6" data-h="8"
                                    data-t="45">Show Rooms [0]</button>

                                <!-- 3 minutes -->
                                <div class="matrix-cell header">3m</div>
                                <button class="matrix-btn browse-btn" data-type="fcfs" data-w="4" data-h="4"
                                    data-t="180">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="fcfs" data-w="4" data-h="6"
                                    data-t="180">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="fcfs" data-w="5" data-h="7"
                                    data-t="180">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="fcfs" data-w="6" data-h="8"
                                    data-t="180">Show Rooms [0]</button>
                            </div>
                        </div>

                        <!-- Split Points -->
                        <div class="game-type-section">
                            <h3>Split Points</h3>
                            <div class="game-matrix">
                                <!-- Header Row -->
                                <div class="matrix-cell empty"></div>
                                <div class="matrix-cell header">4x4</div>
                                <div class="matrix-cell header">4x6</div>
                                <div class="matrix-cell header">5x7</div>
                                <div class="matrix-cell header">6x8</div>

                                <!-- 45 seconds -->
                                <div class="matrix-cell header">45s</div>
                                <button class="matrix-btn browse-btn" data-type="split" data-w="4" data-h="4"
                                    data-t="45">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="split" data-w="4" data-h="6"
                                    data-t="45">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="split" data-w="5" data-h="7"
                                    data-t="45">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="split" data-w="6" data-h="8"
                                    data-t="45">Show Rooms [0]</button>

                                <!-- 3 minutes -->
                                <div class="matrix-cell header">3m</div>
                                <button class="matrix-btn browse-btn" data-type="split" data-w="4" data-h="4"
                                    data-t="180">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="split" data-w="4" data-h="6"
                                    data-t="180">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="split" data-w="5" data-h="7"
                                    data-t="180">Show Rooms [0]</button>
                                <button class="matrix-btn browse-btn" data-type="split" data-w="6" data-h="8"
                                    data-t="180">Show Rooms [0]</button>
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT: Active Rooms -->
                    <div class="lobby-right-panel">
                        <h3>Active Rooms</h3>
                        <div class="selected-game-type" id="selected-game-type">
                            <span class="game-type-label">No game type selected</span>
                        </div>
                        <div class="rating-filter">
                            <label>Filter by Total Rating:</label>
                            <input type="number" id="rating-filter-input" placeholder="e.g. 2400" step="100">
                        </div>
                        <div class="active-rooms-list" id="active-rooms-list">
                            <div class="no-rooms-message">Click "Show Rooms" to view available games</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PLAY TAB -->
            <section id="play" class="tab-content">
                <div class="play-container">
                    <h2>Play Mode</h2>
                    <p>Game content will be displayed here.</p>
                </div>
            </section>

            <!-- SANDBOX MODE -->
            <section id="sandbox" class="tab-content">
                <div class="metrics-bar">
                    <div class="metric">
                        <span class="label">Total</span>
                        <span class="value" id="metric-total">0</span>
                    </div>
                    <div class="metric">
                        <span class="label">Difficult</span>
                        <span class="value" id="metric-difficult">0</span>
                    </div>
                    <div class="metric">
                        <span class="label">6+ Words</span>
                        <span class="value" id="metric-6plus">0</span>
                    </div>
                    <div class="metric">
                        <span class="label">Diff 6+</span>
                        <span class="value" id="metric-diff-6plus">0</span>
                    </div>
                    <div class="metric highlight">
                        <span class="label">6+ Ratio</span>
                        <span class="value" id="metric-ratio">0%</span>
                    </div>
                    <div class="metric">
                        <span class="label">Long 7+</span>
                        <span class="value" id="metric-long">0</span>
                    </div>
                    <div class="metric">
                        <span class="label">Seed</span>
                        <span class="value" id="metric-seed">-</span>
                    </div>
                </div>

                <div class="sandbox-body">
                    <div class="controls-panel">
                        <div class="control-group">
                            <label>Algorithm</label>
                            <select id="algo-select"></select>
                            <p id="algo-desc" class="helper-text"></p>
                        </div>

                        <div class="control-group">
                            <label>Grid Size</label>
                            <div class="row">
                                <input type="number" id="grid-width" value="6" min="3" max="10">
                                <span>x</span>
                                <input type="number" id="grid-height" value="6" min="3" max="10">
                            </div>
                        </div>

                        <div class="control-group">
                            <label>Seed (Optional)</label>
                            <input type="number" id="seed-input" placeholder="Random">
                        </div>

                        <div class="control-group">
                            <label>Constraints & Retries</label>
                            <div class="grid-2-col">
                                <div>
                                    <label class="sub-label">Min Diff.</label>
                                    <input type="number" id="min-difficult" value="0" min="0">
                                </div>
                                <div>
                                    <label class="sub-label">Min Total</label>
                                    <input type="number" id="min-total" value="0" min="0">
                                </div>
                                <div>
                                    <label class="sub-label">Min Ratio %</label>
                                    <input type="number" id="min-ratio" value="0" min="0" max="100">
                                </div>
                                <div>
                                    <label class="sub-label">Max Attempts</label>
                                    <input type="number" id="max-attempts" value="10" min="1" max="50">
                                </div>
                            </div>
                        </div>

                        <div id="algo-params" class="control-group"></div>

                        <button id="generate-btn" class="primary-btn">Generate Puzzle</button>
                    </div>

                    <div class="puzzle-container">
                        <div id="sandbox-grid" class="boggle-grid"></div>
                    </div>

                    <div class="word-list-container">
                        <div class="word-list-header">
                            <h3>Words</h3>
                            <select id="word-filter">
                                <option value="all">All Words</option>
                                <option value="difficult">Difficult Only</option>
                                <option value="6plus">6+ Letters</option>
                                <option value="diff6plus">Difficult 6+</option>
                            </select>
                        </div>
                        <div id="sandbox-words" class="word-list"></div>
                    </div>
                </div>
            </section>

            <!-- PLAY MODE -->
            <section id="play" class="tab-content">
                <div id="play-setup" class="setup-screen">
                    <h2>Select Difficulty</h2>
                    <div class="difficulty-cards">
                        <div class="card" data-difficulty="easy">
                            <h3>Easy</h3>
                            <p>Standard grid, classic feel.</p>
                        </div>
                        <div class="card" data-difficulty="medium">
                            <h3>Medium</h3>
                            <p>Denser letter distribution.</p>
                        </div>
                        <div class="card" data-difficulty="hard">
                            <h3>Hard</h3>
                            <p>Challenging vocabulary.</p>
                        </div>
                    </div>
                    <button id="start-game-btn" class="primary-btn" disabled>Start Game</button>
                </div>

                <div id="play-area" class="game-screen hidden">
                    <div class="game-header">
                        <div class="timer">00:00</div>
                        <button id="end-game-btn" class="secondary-btn">End Game</button>
                    </div>

                    <div class="game-layout">
                        <div class="left-col">
                            <div id="play-grid" class="boggle-grid interactive"></div>
                            <div class="input-area">
                                <input type="text" id="word-input" placeholder="Type word and hit Enter"
                                    autocomplete="off">
                                <div id="message-area"></div>
                            </div>
                        </div>

                        <div class="right-col">
                            <div class="score-board">
                                <div class="score-item">
                                    <span class="label">Score</span>
                                    <span class="value" id="current-score">0</span>
                                </div>
                                <div class="score-item">
                                    <span class="label">Found</span>
                                    <span class="value" id="words-found-count">0</span>
                                </div>
                            </div>
                            <div class="found-words-list" id="player-words"></div>
                        </div>
                    </div>
                </div>

                <div id="play-summary" class="summary-screen hidden">
                    <h2>Game Over!</h2>
                    <div class="summary-stats">
                        <div class="stat">
                            <span class="label">Your Score</span>
                            <span class="value" id="final-score">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">Possible Score</span>
                            <span class="value" id="possible-score">0</span>
                        </div>
                        <div class="stat">
                            <span class="label">Percentage</span>
                            <span class="value" id="score-percentage">0%</span>
                        </div>
                    </div>
                    <div class="missed-words">
                        <h3>Missed Difficult Words</h3>
                        <div id="missed-words-list" class="word-list"></div>
                    </div>
                    <button id="play-again-btn" class="primary-btn">Play Again</button>
                </div>
            </section>
        </main>
    </div>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>